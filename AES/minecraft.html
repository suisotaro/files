<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>ページはロックされています</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.staticrypt-page{width:360px;padding:8% 0 0;margin:auto;box-sizing:border-box}.staticrypt-form{position:relative;z-index:1;background:#FFF;max-width:360px;margin:0 auto 100px;padding:45px;text-align:center;box-shadow:0 0 20px 0 rgba(0,0,0,.2),0 5px 5px 0 rgba(0,0,0,.24)}.staticrypt-form input{outline:0;background:#f2f2f2;width:100%;border:0;margin:0 0 15px;padding:15px;box-sizing:border-box;font-size:14px}.staticrypt-form .staticrypt-decrypt-button{text-transform:uppercase;outline:0;background:#4CAF50;width:100%;border:0;padding:15px;color:#FFF;font-size:14px;cursor:pointer}.staticrypt-form .staticrypt-decrypt-button:hover,.staticrypt-form .staticrypt-decrypt-button:active,.staticrypt-form .staticrypt-decrypt-button:focus{background:#43A047}.staticrypt-html{height:100%}.staticrypt-body{margin-bottom:1em;background:#76b852;background:-webkit-linear-gradient(right,#76b852,#8DC26F);background:-moz-linear-gradient(right,#76b852,#8DC26F);background:-o-linear-gradient(right,#76b852,#8DC26F);background:linear-gradient(to left,#76b852,#8DC26F);font-family:"Arial",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.staticrypt-instructions{margin-top:-1em;margin-bottom:1em}.staticrypt-title{font-size:1.5em}.staticrypt-footer{position:fixed;height:20px;font-size:16px;padding:2px;bottom:0;left:0;right:0;margin-bottom:0}.staticrypt-footer p{margin:2px;text-align:center;float:right}.staticrypt-footer a{text-decoration:none}
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">ページはロックされています</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script>

    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
        e.preventDefault();

        var passphrase = document.getElementById('staticrypt-password').value,
            encryptedMsg = '921db99033bd44c29d8c0414affe207785610da37c1fd32091f6d5e37e8589aa3847bb233af4455fc69cba7753ea35f1445de8a74da15458cd7466df3243d1acn0MgEsWZEs3rnjh1Y5gO4mNrMxayJRyeEE0nu7CQls2PTBiL/2REQ76rpFcuLo/w3Sb4LHhvQuciFoPovYom4mC3YnYrKOEAsxTzZn32DIPJtMUmT/rPfPQdzmO8TfrJGL/eCWbUOoJZxH/MCiEvVOW8R8SaZYnrPUTLMmh0GAsHGdbqysZFJZiTel2EF8eDBfc+Qrej5IO8EQF/10DNbdblB9FXo3to3asMysOtWn5zVhWPSyFg9GPGiFLJqNKlUZH9e6bJAoHue8XGi5xDqIEFyGW+/2Pp4AV18NiHkwPOzeZVPVakA31j+mp641bCoUVJBt4S1SajE/wJg1kPeeA6zpsLegreRqnBA/HBhk2tkHl1P6w8HsUcmQRaK04lowjW/XtvENfiOJDzMHgEzMWBX7RmfWkv74T20OrEEjC++1VVIWMzXIOrPE3JI0lYzguSu+VdBpiyyg9+soGtaNPlq4KktadBhJ+VX4y7N13aUgvv73Ga8vc7wXPo5p2yoLeolsZG04Wru6dyqN9cTMohB2ozm23UeiPD8CMhL2tdwyE59MBZpNFjIy7/C/EDXYaqDSizXs1GUREtYWPrztyilHiZ0DdiKMJPtQj25tHaeya+fNvmgdYRt/AS/Sp0WMEBgqoaHRt1mefTHIgc1aMpWCdZv7mHnTJK9vvGjM9hn43qqFwfLxFFNfAZlmdRS+cO5YCJ9xBq/f8FWXoiNGjOtd/MjOcfVS0wvFsGCQBWqU0gwWz72dq51ZvELQXoxi9xeEfY+BIAEFcyLWGCkxVWItl9qAlbdynBoc/x9fkO9MBjDRI5x3tiFE3D5E3soRvnqcAelS6vmXsFIuGuWUgxifhX6TzC5v1KmmPq/RlicR5pS9tWhUygMHNdGxu22McHcTfFwgP03sngxySZtpBR7RvVRJS8AiHurkBZyEcQ1GCDIIkQ/CDXj9CFNmktmx+6myxo4IA7OUkBTrIH4+toE4o2sAwCHuCUDy/R0KYrK8kpce47sQDhjHDqvrDc24lnTsQ4zYkDgPb5lWnWe/YDkU4vOAvinx9a8G6qXT/rGBu06CE/fvKHPqwxnF1DOzD+fv3JgMxXtJ6EpnZjx1QFSX81drNt7ceDGi72I79qJC3ABIMJIYwZgjDsBMwSNuVq5GXJyfaPhGNGbPQydcK/uFHapab2ULTQLoBpXJ+V7pa2vybBDe/ZXtDP6jFNbF2BDhV4tfvtUjQZ5p70upT449DpTAZyRu/hYxE2Jw9S7aHBqiuiZO4L3WuNBI+CWQaxtSI5rM7LhQ6IZP2IvHATWZ52Cs0H56PtgTdUXmd2FVAb2KBd/Fn7cs2apYOFZHzzlEWSev2+cBerCHighdQkjnVHZVzm1VsjR4oyULsx5VTBBs1y0KzCW58BEVaJeX1leSnkuZDXZt311z3Pfu+u+Muc7QUiiRNA/leIhUEHRfQouO2bbdP7Dgn5ZrMOhAVahSYBZonm8IcatJIkKo9psryj1WMcf+c4mqwVqdoCsuKkOjmHI/s9cW/3/dvkXtzdqQQOauG0FhkqjTDXVikVnVSRvcefbv75yxTLLZG/U0JliRKrlIukgSoWPsD2+sTg/xWVmTHONlXfbjcugO7k0T2+F8F7iQOVueEfRGa2aCkvvTTM7D35Fe/SiQA2tBUN0JtUEbva5mFRAkH64x3WNulaW8oiBgvqjFc1pITt7R3hP/YEyv9kJ8xCBHmyL/1S+NXV8UDLibdrSeZXZeeBVJAEV22hloYqfe6isEGaMfSwzCVtUSeO07PMoWxOd9iHWUyvQPvM3SejhjWVvM+aYuC/juMfqEQU2mohjlSdI8kdkSJ0HUvBI6jRsY/0+qSGZQHhEJAPRDtYPYWHuUI2reZDvitQ2CkyteLcro9p2ays9b0RADqWYIY18TT5GxCD1Dl3/5OB18uQPZB48QDYYWM+5ZEjNajK9NuW25UO0Y9TKoO6Bmvyds0yxMEXSfu5Yt+NzQgT3FJB9nQ+cvkjyHPW432CCHwMhMm79VyFvJuompQtE1trEdbTfs8sBcccg5/c3Wx/Bp1UrOywDvqqdEtHwWVfSOaBJ3nnZNybA4WFOWwphPncnL/J5Q1HNHyiWAChWMOLSfnaFDFD72z+8oKWAhS4VbiIL/qN78Mv69jtwpNc25N6GBwPje7YKSu0IgcqdGiDz4XiRbxijfmnLmbdwIa03ARU5FQb7eyCLvTsWDwX8/5rFdBVOiPuQnsRNghEPWtndeCMPoebekEj55Gmq/hzR2J+iERPludHMCKiHSJ/mJZL0QuvVNdsFSm8UBXvyY0SVLkWg4eI3wv00+MisnuD3CCUg7FrZgiKFFOwCbMUwMo6UvQ/OZaj2mvqG7+awL1cTKvRpvhd59CEsFUE5sUkbRDp3/lQxLwH7IlxhrnhM1PCA28I95Ko4NkpUCerIRVwm5Sg2LqGvPKcAsB7zJL1G0UcPeRnkK7SGqZZanlWRREeAYqNGpggam3J+KqK3/pw53EVyOrg+FLnfU/Ja9A/SDxAVMQyS29Lt9NtoXBfDUNGtUZPi84cNcfz171Gwz5pOKAWzPSmUgMwFCjJj1q+iv7fQ/cu96AoMjJlsFrkvwrVNaugEsI1pC6imaMQKladw762VpACk6wFEHDlVIBtouXUQeBDq5IaPa1x4sZbrINFpVrnYVG7UzM+/iFOezMaNExT+GcLsmYgpzJA2fjVACF7UDvrBHmQuQIxx8fm6WvKPf2gq+EhZsp/CvcEg9c9XZZ3qEkbtFDhKp4/uoMTQV//6/xO5FQZhxoEdWt8qUQy+wF84rMtIuuoPZBwEfSWCqx33Z+ewzB14dwSKL5CbdwgONTBlzG9Pj2rG/OfAp+RTLOeklEp+cmCWABodQ5IXFN1fK9+hGGoscBX0ku7a/jtKF9zTqA=',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            alert('Bad passphrase!');
            return;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);

        document.write(plainHTML);
        document.close();
    });
</script>
</body>
</html>
